(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(e,t){},112:function(e,t,a){"use strict";a.r(t);var n=a(23),s=a(7),r=a(8),o=a(10),l=a(9),i=a(11),c=a(0),m=a.n(c),d=a(53),p=a.n(d),u=a(4),f=a.n(u),h=(a(79),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={query:"",results:[]},a.handleInputChange=function(){a.setState({query:a.search.value.toLowerCase()})},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;if(!this.props.state.me)return m.a.createElement("h4",null,m.a.createElement("center",null,"Loading..."));var t=function(t){if(e.props.state.users)return e.props.state.users.find(function(e){return e.email===t})},a=function(t){return e.props.state.data&&e.props.state.data.find(function(e){return e.userEmail===t})?e.props.state.data.find(function(e){return e.userEmail===t}).message.email!==t?m.a.createElement("div",{id:"normal"},"You: ",e.props.state.data.find(function(e){return e.userEmail===t}).message.text):e.props.state.data.find(function(e){return e.userEmail===t}).message.time>e.props.state.data.find(function(e){return e.userEmail===t}).seenTime?m.a.createElement("div",{id:"bold"},e.props.state.data.find(function(e){return e.userEmail===t}).message.text):m.a.createElement("div",{id:"normal"},e.props.state.data.find(function(e){return e.userEmail===t}).message.text):""};return m.a.createElement("div",{className:"users"},m.a.createElement("input",{placeholder:" \ud83d\udd0d   Search for users...",ref:function(t){return e.search=t},onChange:this.handleInputChange,style:{width:"100%",padding:"4px 5px",backgroundColor:this.props.state.me.color+"52"}}),m.a.createElement("div",{className:"title"},"Friends "),this.props.state.me&&this.props.state.friends_requests&&this.props.state.show&&this.props.state.friends_requests.map(function(n){return m.a.createElement("div",{className:"user request",onClick:function(){return e.props.display(n)},key:t(n)._id},m.a.createElement("div",{className:"first"},m.a.createElement("img",{src:t(n).photo,alt:t(n).username})),m.a.createElement("div",{className:"middle"},m.a.createElement("div",{className:"user-name"},t(n).firstname," ",t(n).lastname,"  "),m.a.createElement("div",{className:"message_fragment"},"  ",a(n),"  ")),m.a.createElement("button",{className:"addFriend",onClick:function(){return e.props.acceptFriendRequest(n)},name:"Accept friend ",title:"Accept friendship request ",style:{backgroundColor:e.props.state.me.color+"cc"}},m.a.createElement("span",{role:"img","aria-label":"Check"},"\u2705 ?")),m.a.createElement("button",{className:"addFriend",onClick:function(){return e.props.deniedFriendRequest(n)},name:"Denied friendship request",title:"Denied friendship request",style:{backgroundColor:e.props.state.me.color+"cc"}},m.a.createElement("span",{role:"img","aria-label":"Delete"},"\u274c"),"?"))}),this&&this.props.state.users&&this.props.state.friends&&this.props.state.friends.length>0?this.props.state.friends.map(function(t){return t.firstname&&t.firstname.toLowerCase().includes(e.state.query)||t.lastname&&t.lastname.toLowerCase().includes(e.state.query)?m.a.createElement("div",{className:(n=t.email,e&&e.props.state.data&&e.props.state.data.find(function(e){return e.userEmail===n})&&e.props.state.data.find(function(e){return e.userEmail===n}).message.email===n&&e.props.state.data.find(function(e){return e.userEmail===n}).message.time>e.props.state.data.find(function(e){return e.userEmail===n}).seenTime?"user-alert":"user"),onClick:function(){return e.props.display(t.email)},key:t._id},m.a.createElement("div",{className:"first"},m.a.createElement("img",{src:t.photo,alt:t.username})),m.a.createElement("div",{className:"middle"},m.a.createElement("div",{className:"user-name"},t.firstname," ",t.lastname," "),m.a.createElement("div",{className:"message_fragment"},"  ",a(t.email),"  ")),m.a.createElement("button",{className:"addFriend",title:"Remove friend",onClick:function(){return e.props.removeFriend(t.email)},style:{backgroundColor:e.props.state.me.color+"cc"}},m.a.createElement("span",{role:"img","aria-label":"Delete"},"\u274c"))):null;var n}):m.a.createElement("center",null," You don't have friends yet "),m.a.createElement("div",{className:"title"},"Sugestions"),this&&this.props.state.sugestions&&this.props.state.sugestions.map(function(t){return t.firstname.toLowerCase().includes(e.state.query)||t.lastname.toLowerCase().includes(e.state.query)?m.a.createElement("div",{className:"user",onClick:function(){return e.props.display(t.email)},key:t._id},m.a.createElement("div",{className:"first"},m.a.createElement("img",{src:t.photo,alt:t.username})),m.a.createElement("div",{className:"middle"},m.a.createElement("div",{className:"user-name"},t.firstname," ",t.lastname," "),m.a.createElement("div",{className:"message_fragment"},"  ",a(t.email),"  ")),e.props.state.me.requests_sent.some(function(e){return e===t.email})?m.a.createElement("button",{className:"addFriend",title:"Revoke friendship request",onClick:function(){return e.props.revokeFriendRequest(t.email)},style:{backgroundColor:e.props.state.me.color+"cc"}},"x"):m.a.createElement("button",{className:"addFriend",title:"Send friendship request",onClick:function(){return e.props.sendFriendRequest(t.email)},style:{backgroundColor:e.props.state.me.color+"cc"}},"Send")):null}))}}]),t}(c.Component)),g=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;if(!this.props.state.me)return m.a.createElement("h4",null,m.a.createElement("center",null,"Loading..."));if(this.props.state.users)var t=this.props.state.users.find(function(t){return t.email===e.props.state.display});var a,n=function(t){if(e.props.state.users)return e.props.state.users.find(function(e){return e.email===t})};return m.a.createElement("div",{className:"profile"},this.props.state.friends_requests&&this.props.state.friends_requests.length>0?m.a.createElement("div",{className:"alert-inform",onClick:this.props.showProfile},m.a.createElement("span",{role:"img","aria-label":"Notification",title:"Notification"},"\ud83d\udd14"),"You have ",this.props.state.friends_requests.length," friendship requests! ",m.a.createElement("br",null),"Click to view"):null,m.a.createElement("div",{className:"title"},"Profile"),t&&t.last_activity&&Date.now()-t.last_activity<12e4?m.a.createElement("div",{className:"last-activity"},m.a.createElement("span",{id:"online-bullet"},m.a.createElement("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/31/Button_Icon_Green.svg/768px-Button_Icon_Green.svg.png",alt:"Online",title:"Online"})),"Online"):m.a.createElement("div",{className:"last-activity"},"Last activity: ",m.a.createElement("br",null),m.a.createElement("b",null,t&&(a=t.last_activity,new Date(a).toLocaleTimeString("en-EN",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))," ")),m.a.createElement("div",{className:"name"},t&&t.firstname," ",t&&t.lastname),m.a.createElement("img",{src:t&&t.photo,alt:t&&t.email}),m.a.createElement("div",{className:"tel"},"Phone: ",t&&t.tel),m.a.createElement("div",{className:"email"},"Email: ",t&&t.email),this.props.state.display===this.props.state.me.email?m.a.createElement("div",null,m.a.createElement("h6",null,"Click and select your favorite color: "),m.a.createElement("input",{type:"color",style:{width:" 30px",height:" 30px",borderRadius:"50%",display:"inline"},name:"favcolor",id:"favcolor",defaultValue:this.props.state.color,onChange:this.props.updateData}),m.a.createElement("input",{type:"submit",value:"Save",onClick:this.props.setColor,style:{backgroundColor:this.props.state.me.color,padding:" 4px 12px",display:"inline",position:"relative",top:"-5px"}})):null,m.a.createElement("div",{className:"his-friends"},m.a.createElement("div",{className:"title"},"User's friends"),t&&t.friends&&t.friends.filter(function(t){return t!==e.props.state.me.email}).map(function(t){return m.a.createElement("div",{className:"user",onClick:function(){return e.props.display(t)},key:n(t)._id},m.a.createElement("div",{className:"first"},m.a.createElement("img",{className:"friend-photo",src:n(t).photo,alt:n(t).username})),m.a.createElement("div",{className:"middle"},m.a.createElement("div",{className:"user-name",style:{top:"18px"}},n(t).firstname," ",n(t).lastname)),e.props.state.me.requests_sent.some(function(e){return e===t})||e.props.state.me.friends.some(function(e){return e===t})?m.a.createElement("button",{className:"addFriend",title:"Revoke friendship request",onClick:function(){return e.props.revokeFriendRequest(t)},style:{backgroundColor:e.props.state.me.color+"cc"}},"x"):m.a.createElement("button",{className:"addFriend",title:"Send friendship request",onClick:function(){return e.props.sendFriendRequest(t)},style:{backgroundColor:e.props.state.me.color+"cc"}},"Send"))})))}}]),t}(c.Component),E=function(e){return m.a.createElement("div",{className:"wrapper fadeInDown"},m.a.createElement("div",{id:"formContent"},m.a.createElement("div",{className:"fadeIn first"},m.a.createElement("i",{className:"fa fa-user"}," Edit your profile")),m.a.createElement("table",null,m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"firstname",className:"fadeIn second",name:"firstname",placeholder:"Firstname",onChange:e.updateData,defaultValue:e.state.me.firstname})),m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"lastname",className:"fadeIn second",name:"lastname",placeholder:"Lastname",onChange:e.updateData,defaultValue:e.state.me.lastname}))),m.a.createElement("tr",null,m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"password",className:"fadeIn second",name:"password",placeholder:"Old password",onChange:e.updateData})),m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"rpassword",className:"fadeIn second",name:"rpassword",placeholder:"New password",onChange:e.updateData}))),m.a.createElement("tr",null,m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"tel",className:"fadeIn second",name:"tel",placeholder:"Phone",onChange:e.updateData,defaultValue:e.state.me.tel})),m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"photo",className:"fadeIn second",name:"photo",placeholder:"Photo",onChange:e.updateData,defaultValue:e.state.me.photo}))))),m.a.createElement("input",{type:"submit",className:"fadeIn fourth",onClick:e.profileChange,value:"Submit"})," ",m.a.createElement("br",null),e.state.inform?m.a.createElement("label",{id:"inform"},e.state.inform):null))},v=function(e){return m.a.createElement("div",{className:"wrapper fadeInDown"},m.a.createElement("div",{id:"formContent"},m.a.createElement("div",{className:"fadeIn first"},m.a.createElement("i",{className:"fa fa-user"}," Info")),m.a.createElement("h5",null,"Conversation are allowed only between friends."),m.a.createElement("h5",null,"So, make some friends...",m.a.createElement("span",{role:"img","aria-label":"Check"},"\ud83e\udd1d")),e.state.inform?m.a.createElement("label",{id:"inform"},e.state.inform):null,m.a.createElement("div",{id:"formFooter"})))},y=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).state={query:"",results:[]},a.handleInputChange=function(){a.setState({query:a.search.value.toLowerCase()})},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentWillReceiveProps",value:function(){this.props.scrollUP()}},{key:"render",value:function(){var e=this;var t=0,a=function(a,n){if((a>1&&n.email!==e.props.state.conversation[a-1].email||a>1&&n.time-e.props.state.conversation[a-1].time>36e5)&&(t=0),a>1&&1===t&&document.getElementById(a)&&(document.getElementById(a-t).className="text-mesage up",document.getElementById(a).className="text-mesage down"),a>1&&t>1&&document.getElementById(a)&&(document.getElementById(a-1).className="text-mesage middle",document.getElementById(a).className="text-mesage down",document.getElementById(a-t).className="text-mesage up"),t++,n.email!==e.props.state.me.email)return{backgroundColor:e.props.state.me.color+"bd"}},n=function(t,a){return e.props.state.me.email!==t?(a>1&&e.props.state.conversation[a-1].email," oriented-left "):(a>1&&e.props.state.conversation[a-1].email," oriented-right ")};if(this&&null!==this.props.state.participants&&this.props.state.participants)var s=this.props.state.participants[0]&&this.props.state.participants.find(function(t){return t.email!==e.props.state.me.email}).seen;else s=null;return this.props.state.profile_edit?m.a.createElement("div",{className:"edit-profile"},m.a.createElement(E,{state:this.props.state,updateData:this.props.updateData,profileChange:this.props.profileChange})):this&&!this.props.state.conversation?m.a.createElement("div",{className:"edit-profile"},m.a.createElement(v,{state:this.props.state})):m.a.createElement("div",{id:"intermediate"},m.a.createElement("input",{placeholder:" \ud83d\udd0d  Search for messages... ",ref:function(t){return e.search=t},onChange:this.handleInputChange,style:{width:"100%",padding:"4px 10px",backgroundColor:this.props.state.me.color+"52"}}),m.a.createElement("div",{className:"title"},"Conversations"),m.a.createElement("div",{id:"conversation"},this.props.state.conversation&&this.props.state.conversation.map(function(t,r){return t.text.toLowerCase().includes(e.state.query)?m.a.createElement("div",{key:r,id:"message",className:n(t.email,r)},r>1&&t.time-e.props.state.conversation[r-1].time>36e5||0===r?m.a.createElement("div",{className:"date-time"}," ",(o=t.time,new Date(o).toLocaleDateString("en-EN",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))):null,m.a.createElement("span",{className:"text-mesage",style:a(r,t),id:r}," ",t.text," "),t.email===e.props.state.me.email?t.time>=s?m.a.createElement("span",{role:"img",className:"unseed","aria-label":"Check unseen",title:"Message useen"}," \u2714"):m.a.createElement("img",{src:"https://www.clipartmax.com/png/full/51-513171_seen-whatsapp-vector.png",alt:"seen",title:"Message seen",width:"16"}):null,m.a.createElement("span",{className:"time-message"}," ",function(e){return new Date(e).toLocaleTimeString()}(t.time))):null;var o})))}}]),t}(m.a.Component),w=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).keyEnter=function(e){13!==e.charCode&&13!==e.keyCode||a.props.sendMessage()},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return m.a.createElement("div",{id:"block"},m.a.createElement("div",{className:"head",style:{backgroundColor:this.props.state.me.color}},m.a.createElement("table",{className:"right-side"},m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",null,m.a.createElement("span",{role:"img","aria-label":"Edit",title:"Edit your profile",id:"edit-profile",onClick:this.props.editProfile},"\u2699")),m.a.createElement("td",null,m.a.createElement("span",{role:"img","aria-label":"Profile",title:"Profile",id:"profile",onClick:this.props.showProfile}," ","\ud83d\udc68\u200d\ud83d\udd27",m.a.createElement("span",{id:"counter",title:"Friends requests"},this.props.state.me&&this.props.state.me.friends_requests?this.props.state.me.friends_requests.length:m.a.createElement("span",null,"0")))),m.a.createElement("td",null,m.a.createElement("button",{id:"logout",onClick:this.props.logout},"Log Out")))))),m.a.createElement("div",{className:"box"},m.a.createElement("div",{className:"left"},m.a.createElement(h,{display:this.props.display,state:this.props.state,sendFriendRequest:this.props.sendFriendRequest,revokeFriendRequest:this.props.revokeFriendRequest,deniedFriendRequest:this.props.deniedFriendRequest,acceptFriendRequest:this.props.acceptFriendRequest,removeFriend:this.props.removeFriend})),m.a.createElement("div",{className:"center",id:"scroll"},m.a.createElement(y,{state:this&&this.props.state,updateData:this.props.updateData,scrollUP:this.props.scrollUP,profileChange:this.props.profileChange}),this.props.state.me&&this.props.state.me.friends&&this.props.state.me.friends.some(function(t){return t===e.props.state.display})?m.a.createElement("div",{id:"inputMessage",style:{backgroundColor:this.props.state.me.color+"52"}},this.props.state.info?m.a.createElement("label",{id:"inform"},this.props.state.info):null,m.a.createElement("input",{type:"text",placeholder:"Your message",onChange:this.props.updateData,id:"message",name:"message",value:this.props.state.message,onKeyDown:this.keyEnter}),m.a.createElement("span",null,m.a.createElement("input",{type:"submit",style:{backgroundColor:this.props.state.me.color},id:"message-submit",value:"Send",onClick:this.props.sendMessage}))):null),m.a.createElement("div",{className:"right"},m.a.createElement(g,{state:this.props.state,showProfile:this.props.showProfile,display:this.props.display,setColor:this.props.setColor,updateData:this.props.updateData,sendFriendRequest:this.props.sendFriendRequest,revokeFriendRequest:this.props.revokeFriendRequest}))))}}]),t}(c.Component),k=function(e){return m.a.createElement("div",{className:"wrapper fadeInDown"},m.a.createElement("div",{id:"formContent"},m.a.createElement("div",{className:"fadeIn first"},m.a.createElement("i",{className:"fa fa-user"}," Login")),m.a.createElement("input",{type:"text",id:"myEmail",className:"fadeIn second",name:"Email",placeholder:"Email",onChange:e.updateData,value:e.myEmail}),m.a.createElement("input",{type:"text",id:"password",className:"fadeIn third",name:"password",placeholder:"Password",onChange:e.updateData,value:e.password}),m.a.createElement("input",{type:"submit",className:"fadeIn fourth",value:"Log In",onClick:e.tryLogin}),"   ",m.a.createElement("br",null),e.state.inform?m.a.createElement("label",{id:"inform"},e.state.inform):null,m.a.createElement("div",{id:"formFooter"},m.a.createElement("p",{className:"underlineHover",onClick:e.changeForm},"You don't have a count? ",m.a.createElement("b",null,"Register!")))))},b=function(e){return m.a.createElement("div",{className:"wrapper fadeInDown"},m.a.createElement("div",{id:"formContent"},m.a.createElement("div",{className:"fadeIn first"},m.a.createElement("i",{className:"fa fa-user"}," Register")),m.a.createElement("table",null,m.a.createElement("tbody",null,m.a.createElement("tr",null,m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"username",className:"fadeIn second",name:"username",placeholder:"Username",onChange:e.updateData})),m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"email",className:"fadeIn second",name:"email",placeholder:"Email",onChange:e.updateData}))),m.a.createElement("tr",null,m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"firstname",className:"fadeIn second",name:"firstname",placeholder:"Firstname",onChange:e.updateData})),m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"lastname",className:"fadeIn second",name:"lastname",placeholder:"Lastname",onChange:e.updateData}))),m.a.createElement("tr",null,m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"password",className:"fadeIn second",name:"password",placeholder:"Password",onChange:e.updateData})),m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"rpassword",className:"fadeIn second",name:"rpassword",placeholder:"Repeat password",onChange:e.updateData}))),m.a.createElement("tr",null,m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"tel",className:"fadeIn second",name:"tel",placeholder:"Phone",onChange:e.updateData})),m.a.createElement("td",null,m.a.createElement("input",{type:"text",id:"photo",className:"fadeIn second",name:"photo",placeholder:"Photo",onChange:e.updateData}))))),m.a.createElement("input",{type:"submit",className:"fadeIn fourth",onClick:e.tryRegister,value:"Register"})," ",m.a.createElement("br",null),e.state.inform?m.a.createElement("label",{id:"inform"},e.state.inform):null,m.a.createElement("div",{id:"formFooter"},m.a.createElement("p",{className:"underlineHover",onClick:e.changeForm},"Do you have a count?",m.a.createElement("b",null,"Login!")," "))))},C=a(54),N=a.n(C),q=a(55),I=a(12),D=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(o.a)(this,Object(l.a)(t).call(this))).loadData=function(t){console.log("-----loadData-------:");var a=N()(e.state.endpoint);a.on("usersAPI",function(a){console.log("socket was connected and response:",a),e.sortUsers(a,t)}),a.on("fragmentAPI"+t,function(t){return e.setState({data:t})}),a.on("conversationAPI"+t,function(t){return e.setState({conversation:t.messages,participants:t.participants})})},e.sortUsers=function(t,a){if(a||(a=e.state.myEmail),t)var n=t.find(function(e){return e.email===a}),s=n&&t.filter(function(e){return e.email!==n.email}).filter(function(e){return e.email!==n.friends.find(function(t){return t===e.email})}).filter(function(e){return e.email!==n.friends_requests.find(function(t){return t===e.email})}).sort(function(e,t){return e.last_activity>t.last_activity?-1:e.last_activity<t.last_activity?1:0}),r=n&&t.filter(function(e){return e.email===n.friends.find(function(t){return t===e.email})}).sort(function(e,t){return e.last_activity>t.last_activity?-1:e.last_activity<t.last_activity?1:0});e.setState({users:t,me:n,sugestions:s,friends:r,friends_requests:n.friends_requests,requests_sent:n.requests_sent,authorized:!0}),""===e.state.display&&r.length>0?e.display(r[0].email):""===e.state.display&&0===r.length&&e.display(e.state.sugestions[0].email)},e.display=function(t){e.state.profile_edit&&e.setState({profile_edit:!1,inform:""}),f.a.get("http://localhost:4000/conversation",{headers:{token:window.localStorage.getItem("token"),hisemail:t}}).then(function(a){if(null!==a.data.data)e.setState({display:t,inform:""});else{var n=[{text:"Conversations are allowed only between friends :)).",email:e.state.me.email,time:Date.now()}];e.setState({display:t,conversation:n,participants:[],inform:""})}}).catch(function(a){console.log("Error in DB for display conversation",a),e.setState({display:t,inform:""})}),e.scrollUP()},e.updateData=function(t){var a;e.setState((a={},Object(n.a)(a,t.target.id,t.target.value),Object(n.a)(a,"inform",""),Object(n.a)(a,"info",""),a))},e.setColor=function(){if(e.state.color)var t=e.state.favcolor;else t=e.state.me.color;f.a.post("http://localhost:4000/changecolorprofile",{token:window.localStorage.getItem("token"),color:t}).then(function(t){e.loadData(),e.state.me.email&&e.setState({inform:t.data.inform,display:e.state.me.email,color:e.state.favcolor})}).catch(function(e){console.log(e,"eroare la accesare")})},e.profileChange=function(){if(e.state.firstname)var t=e.state.firstname;else t=e.state.me.firstname;if(e.state.lastname)var a=e.state.lastname;else a=e.state.me.lastname;if(e.state.tel)var n=e.state.tel;else n=e.state.me.tel;if(e.state.photo)var s=e.state.photo;else s=e.state.me.photo;if(e.state.color)var r=e.state.color;else r=e.state.me.color;f.a.post("http://localhost:4000/changeprofile",{token:window.localStorage.getItem("token"),firstname:t,lastname:a,original_pass:e.state.password,new_pass:e.state.rpassword,tel:n,photo:s,color:r}).then(function(t){e.state.me.email&&e.setState({inform:t.data.inform,display:e.state.me.email})}).catch(function(t){console.log(t,"error"),e.setState({inform:"Old password didn't match!"})})},e.changeForm=function(){e.setState({autentificate:!e.state.autentificate})},e.logout=function(){window.localStorage.removeItem("token"),e.setState(e.initialstate)},e.scrollUP=function(){var e=document.getElementById("conversation");null!==e&&(e.scrollTop=e.scrollHeight)},e.showProfile=function(){e.setState({show:!e.state.show,display:e.state.me.email})},e.editProfile=function(){e.setState({profile_edit:!e.state.profile_edit,display:e.state.me.email,inform:" If you don't want change your password, just leave the fields empty"})},e.sendMessage=function(){""!==e.state.message&&(e.state.message.length>1e3?e.setState({info:"This message is longer than 1000 characters!"}):(f.a.post("http://localhost:4000/addmessage",{token:window.localStorage.getItem("token"),hisemail:e.state.display,message:e.state.message}).then(function(t){e.setState({message:"",info:""}),e.scrollUP()}).catch(function(t){console.log(t),e.setState({message:"",info:"This message is longer than 1000 characters!"})}),e.scrollUP()))},e.tryRegister=function(){e.state.rpassword===e.state.password?f.a.post("http://localhost:4000/register",{username:e.state.username,email:e.state.email,firstname:e.state.firstname,lastname:e.state.lastname,password:e.state.password,tel:e.state.tel,photo:e.state.photo}).then(function(t){console.log(t),e.setState({inform:t.data.inform})}).catch(function(t){e.setState({inform:t.response.data.inform}),console.log(t)}):e.setState({inform:"Passwords don't match!"})},e.tryLogin=function(){f.a.post("http://localhost:4000/login",{email:e.state.myEmail,password:e.state.password}).then(function(t){t.data.token&&e.state.myEmail===t.data.myEmail?(e.secretToken=t.data.token,window.localStorage.setItem("token",t.data.token),e.setState({authorized:!0,inform:t.data.inform}),e.loadData(t.data.myEmail)):e.setState({inform:t.data.inform})}).catch(function(t){e.setState({inform:"Wrong combination!"}),console.log(t)})},e.sendFriendRequest=function(e){f.a.post("http://localhost:4000/sendfriendrequest",{token:window.localStorage.getItem("token"),email_target:e}).then(function(e){}).catch(function(e){console.log(e,"eroare la accesare")})},e.revokeFriendRequest=function(e){f.a.post("http://localhost:4000/revokefriendrequest",{token:window.localStorage.getItem("token"),email_target:e}).then(function(e){}).catch(function(e){console.log(e,"eroare la accesare")})},e.deniedFriendRequest=function(e){f.a.post("http://localhost:4000/deniedfriendrequest",{token:window.localStorage.getItem("token"),email_target:e}).then(function(e){}).catch(function(e){console.log(e,"eroare la accesare")})},e.acceptFriendRequest=function(e){f.a.post("http://localhost:4000/acceptfriendrequest",{token:window.localStorage.getItem("token"),email_target:e}).then(function(e){}).catch(function(e){console.log(e,"eroare la accesare")})},e.removeFriend=function(e){window.confirm("You will delete this user from your friends list. Are you sure?")&&f.a.post("http://localhost:4000/removefriend",{token:window.localStorage.getItem("token"),email_target:e}).then(function(e){}).catch(function(e){console.log(e,"eroare la accesare")})},e.checkToken=function(t){t||(t=window.localStorage.getItem("token")),f.a.post("http://localhost:4000/checkToken",{token:t}).then(function(t){e.setState({authorized:t.data.authorized,myEmail:t.data.myEmail,loaded:!0}),e.loadData(t.data.myEmail)}).catch(function(e){console.log(e,"DB acces error")})},e.initialstate={username:"",email:"",firstname:"",lastname:"",password:"",rpassword:"",tel:"",photo:"",message:"",inform:"",info:"",myEmail:"",me:"",color:"#56baed",users:[],autentificate:!0,authorized:!1,display:"",conversation:[],friends_requests:[],requests_sent:[],friends:[],sugestions:[],participants:[],show:!1,profile_edit:!1,data:[],loaded:!1,response:!1,endpoint:Object({NODE_ENV:"production",PUBLIC_URL:""}).PORT||"http://localhost:4000"},e.state=e.initialstate,e}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){window.localStorage.getItem("token")&&0===this.state.users.length&&this.checkToken()}},{key:"render",value:function(){var e=this;return m.a.createElement(q.a,null,this.state.authorized?m.a.createElement(I.a,{to:"/"}):this.state.autentificate?m.a.createElement(I.a,{to:"/login"}):m.a.createElement(I.a,{to:"/register"}),m.a.createElement(I.d,null,m.a.createElement(I.b,{exact:!0,path:"/",render:function(t){return m.a.createElement(w,{loadData:e.loadData,logout:e.logout,display:e.display,state:e.state,updateData:e.updateData,sendMessage:e.sendMessage,sendFriendRequest:e.sendFriendRequest,revokeFriendRequest:e.revokeFriendRequest,deniedFriendRequest:e.deniedFriendRequest,acceptFriendRequest:e.acceptFriendRequest,removeFriend:e.removeFriend,showProfile:e.showProfile,editProfile:e.editProfile,profileChange:e.profileChange,scrollUP:e.scrollUP,setColor:e.setColor})}}),m.a.createElement(I.b,{path:"/login",render:function(t){return m.a.createElement(k,{updateData:e.updateData,state:e.state,tryLogin:e.tryLogin,changeForm:e.changeForm})}}),m.a.createElement(I.b,{path:"/register",render:function(t){return m.a.createElement(b,{updateData:e.updateData,state:e.state,tryRegister:e.tryRegister,changeForm:e.changeForm})}})))}}]),t}(m.a.Component),F=document.getElementById("root");p.a.render(m.a.createElement(D,null),F)},58:function(e,t,a){e.exports=a(112)},79:function(e,t,a){}},[[58,1,2]]]);
//# sourceMappingURL=main.7994f33f.chunk.js.map